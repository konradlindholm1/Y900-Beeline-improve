(function(){function A(E){if((typeof E.length!=="number")||E.length===0){return[]}var D=[];for(var C in E[0]){D.push({headerText:C,headerTextTrans:C,rowText:C,columnType:C,width:C,sortable:C})}return D}ko.simpleGrid={viewModel:function(D){var C=this;C.sideNumber=3;C.midNumber=1+2*C.sideNumber;C.allNumber=C.midNumber+2;C.showMenu=false;C.className="ko-grid colorHoverTable "+(D.tableClass?D.tableClass:"");C.ellipsisLength=16;C.searchInitStatus=ko.observable();C.searchKey=ko.observable();C.searchColumns=D.searchColumns;C.primaryColumn=D.primaryColumn;C.showPager=!!D.showPager;C.sortField=ko.observable(D.defaultSortField);C.sortDirection=ko.observable(D.defaultSortDirection);C.data=ko.observableArray(D.data);C.pageToGo=ko.observable();C.sortedData=ko.computed(function(){var F=C.sortField();var E=C.sortDirection();if(F&&E){return C.data().sort(function(G,H){return E=="ASC"?G[F].localeCompare(H[F]):H[F].localeCompare(G[F])})}else{return C.data()}});C.checkedCount=ko.observable(0);C.translate=function(){$(".ko-grid").translate();if($("#pblist tr").length>0){$("#pblist-checkall").removeClass("disable")}else{$("#pblist-checkall").addClass("disable")}};C.clearCheck=function(){$("#ko_grid_checkAll").removeAttr("checked");$("#pblist-checkall").removeClass("checkbox_selected");$("p:checkbox[target='pblist-checkall']").removeAttr("checked");$("p[id^='chk__'] ").removeClass("checkbox_selected");$("p[id^='chk__'] :checkbox").removeAttr("checked");C.checkedCount(0);C.translate()};C.searchText=ko.computed(function(){C.clearCheck();var E="";if(!C.searchInitStatus()){E=$.trim(C.searchKey())}return E});C.afterSearchData=ko.computed(function(){var E=$.trim(C.searchText()).toLowerCase();if(E==""){return C.sortedData()}else{return _.filter(C.sortedData(),function(F){for(var H=0;H<C.searchColumns.length;H++){var G=C.searchColumns[H];if(F[G].toLowerCase().indexOf(E)!=-1){return true}}return false})}});C.currentPageIndex=ko.observable(0);C.pageSize=D.pageSize||5;C.columns=D.columns||A(ko.utils.unwrapObservable(C.afterSearchData()));C.rowClickHandler=D.rowClickHandler;C.hasRowClickHandler=!!D.rowClickHandler;C.EditClickHandler=D.EditClickHandler;C.DeleteClickHandler=D.DeleteClickHandler;C.deleteHandler=D.deleteHandler;C.idName=D.idName;C.tmplType=D.tmplType;C.changeTemplateHandler=D.changeTemplateHandler;C.maxPageIndex=ko.computed(function(){return Math.ceil(ko.utils.unwrapObservable(C.afterSearchData()).length/C.pageSize)-1});C.radioClickExtend=D.radioClickHandler;C.radioChecked4Column=D.radioChecked4Column;C.radioChecked4Value=D.radioChecked4Value;C.fixCurrentPageIndex=function(F){if(F<0){return 0}var E=C.maxPageIndex();return F>E?E:F};C.pagerStart=ko.computed(function(){var E=C.fixCurrentPageIndex(C.currentPageIndex());var F=C.maxPageIndex();var G=0;if(E<C.midNumber||F<=C.allNumber){G=1}else{if(E+C.sideNumber>=F){G=F-C.midNumber}else{G=E-C.sideNumber}}return G});C.pagerEnd=ko.computed(function(){var E=C.fixCurrentPageIndex(C.currentPageIndex());var F=C.maxPageIndex();var G=0;if(E+C.sideNumber>=F||F<=C.allNumber){G=F-1}else{if(E<C.midNumber){G=C.midNumber}else{G=E+C.sideNumber}}if(F-G==2){G=F-1}return G});C.itemsOnCurrentPage=ko.computed(function(){C.translate();var E=C.fixCurrentPageIndex(C.currentPageIndex());var F=C.pageSize*E;return C.afterSearchData().slice(F,F+C.pageSize)});C.changePage=function(E){var E=C.fixCurrentPageIndex(E);C.currentPageIndex(E);C.clearCheck()};C.nextPage=function(){var E=C.fixCurrentPageIndex(C.currentPageIndex()+1);C.currentPageIndex(E);C.clearCheck()};C.previousPage=function(){var E=C.fixCurrentPageIndex(C.currentPageIndex()-1);C.currentPageIndex(E);C.clearCheck()};C.clearAllChecked=function(){$("#pblist-checkall").trigger("click");if($("#pblist-checkall").hasClass("checkbox_selected")){$("#pblist-checkall").trigger("click")}};C.clickCheckAll=function(){if($("#pblist-checkall").hasClass("checkbox_selected")){C.checkedCount(0)}else{var E=$("#pblist :checkbox").length;C.checkedCount(E)}};C.clickCheck=function(E){var G=$("#chk__"+E+" :checkbox");if(G.attr("checked")){G.removeAttr("checked")}else{G.attr("checked","checked")}checkCheckbox(G);var F=$("#pblist p.checkbox_selected :checkbox").length;C.checkedCount(F)};C.selectedItems=function(G){var F;if(C.tmplType=="card"){F=$("#pblist :checkbox[checked='checked']")}else{F=$("#pblist :checkbox[checked='checked']")}var E=[];if(G=="primary"){F.each(function(){E.push($(this).attr("primaryValue"))})}else{F.each(function(){E.push($(this).val())})}return E};C.selectedIds=function(){return C.selectedItems("id")};C.selectedPrimaryValue=function(){return C.selectedItems("primary")};C.radioSelectValue=function(){if($.browser.msie&&event&&event.srcElement&&event.srcElement.type=="radio"){return event.srcElement.value}return $("#pblist [name='ko_grid_radio']:checked").val()};C.radioSelectedPrimaryValue=function(){if($.browser.msie&&event&&event.srcElement&&event.srcElement.type=="radio"){return event.srcElement.attribute("primaryValue")}return $("#pblist [name='ko_grid_radio']:checked").attr("primaryValue")};C.radioClick=function(){C.checkedCount(C.checkedCount()+1)};C.clearRadioSelect=function(){$("#pblist [name='ko_grid_radio']:checked").removeAttr("checked");C.checkedCount(0)};C.setRadioSelect=function(E){$("#pblist [name='ko_grid_radio'][value='"+E+"']").attr("checked","checked");C.checkedCount(1)};C.sort=function(G){if(G==undefined){return}var F=C.sortField();var E="ASC";if(G==F){E=(C.sortDirection()=="ASC")?"DESC":"ASC"}C.sortField(G);C.sortDirection(E);C.data(C.data().sort(function(I,H){return E=="ASC"?I[G].localeCompare(H[G]):H[G].localeCompare(I[G])}));C.currentPageIndex(0);C.clearCheck();$(".ko-grid thead th.ko-grid-th-asc").removeClass("ko-grid-th-asc").addClass("ko-grid-th-sortable");$(".ko-grid thead th.ko-grid-th-desc").removeClass("ko-grid-th-desc").addClass("ko-grid-th-sortable");if(E=="ASC"){$("#ko_grid_th_"+G).removeClass().addClass("ko-grid-th-asc")}else{$("#ko_grid_th_"+G).removeClass().addClass("ko-grid-th-desc")}};C.ellipsisText=function(F){if(!F){return""}if((F.length*2)<C.ellipsisLength){return F}var E=0;for(var G=0;G<F.length;G++){if(F.charCodeAt(G)>256){E+=2}else{E++}if(E>=C.ellipsisLength){return F.substring(0,G)+"..."}}return F}}};var B=new ko.nativeTemplateEngine();B.addTemplate=function(C,D){if($("#"+C)[0]){$("#"+C).remove()}$("#container").append("<script type='text/html' id='"+C+"'>"+D+"</script>")};ko.bindingHandlers.simpleGrid={init:function(D,E){var C=E();if(C.rowClickHandler==undefined){C.rowClickHandler=function(){}}if(C.deleteHandler==undefined){C.deleteHandler=function(){}}if(C.radioClickExtend==undefined){C.radioClickHandler=function(){C.radioClick();return true}}else{C.radioClickHandler=function(){C.radioClick();C.radioClickExtend();return true}}ko.utils.arrayMap(C.columns,function(F){if(F.columnType==undefined){F.columnType="text"}if(F.sortable==undefined){F.sortable=false}if(F.headerTextTrans==undefined){F.headerTextTrans=""}if(F.display==undefined){F.display=true}if(F.needTrans==undefined){F.needTrans=false}});if(C.tmplType=="card"){B.addTemplate("ko_simpleGrid_grid","                <div class='ko-grid-container'>                    <div class='ko-grid-menu' data-bind='visible:showMenu'>                        <div class='ko-grid-option'>                            <img id='ko_grid_layout' class='cursor-pointer' src='images/list.png' data-bind='click:changeTemplateHandler'/>                            <p id=\"pblist-checkall\" target=\"pblist\" class=\"checkbox checkboxToggle\">                                <input type='checkbox' id='ko_grid_checkAll' data-bind='visible: tmplType==\"card\"&&data().length>0,click: clickCheckAll' />                            </p>                        </div>                        <div class='clean'></div>                    </div>                    <div id=\"pblist\" class=\"ko-grid\" data-bind=\"foreach: itemsOnCurrentPage\">                        <div class=\"ko-grid-card\" >                            <div class=\"ko-grid-card-content\" data-bind=\"foreach: $parent.columns ,click:function(){$root.rowClickHandler($data[$root.idName])}\">                                <!-- ko if: display==true -->                                <p data-bind=\"attr:{title:typeof rowText == 'function' ? rowText($parent) : $parent[rowText]},text: $root.ellipsisText(typeof rowText == 'function' ? rowText($parent) : $parent[rowText])\"></p>                                <!-- /ko -->                            </div>                            <div class=\"ko-grid-card-delete\" data-bind=\"click:function(){$root.deleteHandler($data[$root.idName]);}\" >\u8133</div>                            <div class=\"ko-grid-card-check\" ><p class=\"checkbox\"><input type='checkbox' data-bind='value: $data[$root.idName],attr:{primaryValue:$data[$root.primaryColumn]}' target=\"pblist-checkall\"/></p></div>                        </div>                     <div>                </div>")}else{B.addTemplate("ko_simpleGrid_grid","                <div class='ko-grid-container'>                    <div class='ko-grid-menu' data-bind='visible:showMenu'>                        <div class='ko-grid-option'>                            <img id='ko_grid_layout' class='cursor-pointer' src='images/card.png'  data-bind='click:changeTemplateHandler'/>                        </div>                        <div class='clean'></div>                    </div>                    <table data-bind=\"attr:{'class':className}\" cellspacing=\"0\" cellspadding='0'>                    <thead>                        <tr data-bind=\"foreach: columns\" >                           <!-- ko if: columnType=='checkbox' -->                              <th data-bind='attr:{width:width}, visible: display'>                                  <p id=\"pblist-checkall\" target=\"pblist\" class=\"checkbox checkboxToggle\" data-bind='click:$root.clickCheckAll'><input type='checkbox' id='ko_grid_checkAll'/>                                  </p>                              </th>                          <!-- /ko -->                            <!-- ko if: columnType=='text' || columnType=='images' || columnType=='custome' -->                               <!-- ko if: sortable==true -->                               <th data-bind=\"visible: display, css: {'ko-grid-th-sortable':rowText!=$root.sortField(),'ko-grid-th-desc':(rowText==$root.sortField() && 'DESC'==$root.sortDirection()),'ko-grid-th-asc': (rowText==$root.sortField() && 'ASC'==$root.sortDirection())},attr:{id:'ko_grid_th_'+rowText,width:width},click:function(event,data){$root.sort(rowText)}\"><a href='#' data-bind=\"attr:{trans: headerTextTrans}\"></a></th>                               <!-- /ko -->                                <!-- ko if: sortable==false -->                               <th nowrap='nowrap' data-bind=\"visible: display, attr:{width:width,trans: headerTextTrans}\"></th>                               <!-- /ko -->                            <!-- /ko -->                            <!-- ko if: columnType=='radio' -->                               <th nowrap='nowrap' data-bind=\"visible: display, attr:{width:width,trans: headerTextTrans}\"></th>                           <!-- /ko -->                         </tr>                    </thead>                   <tbody id=\"pblist\" data-bind=\"foreach: itemsOnCurrentPage\">                   <tr data-bind=\"foreach: $parent.columns,css:{'odd': $index() % 2==1,'even':$index()%2==0 } \">           <!-- ko if: columnType=='checkbox' -->                          <td class = 'ko-grid-center'><p class=\"checkbox\" manualControl='true' data-bind='attr:{id:\"chk__\"+ $parent[rowText]},click:function(){$root.clickCheck($parent[rowText])}'><input type='checkbox' data-bind='value: $parent[rowText],attr:{primaryValue:$parent[$root.primaryColumn]}' target=\"pblist-checkall\"/></p></td>                            <!-- /ko -->                             <!-- ko if: columnType=='radio' -->                         <td class = 'ko-grid-center'><input type='radio' name='ko_grid_radio' data-bind='click:$root.radioClickHandler,value: $parent[rowText],attr:{primaryValue:$parent[$root.primaryColumn]}'/></td> <!-- /ko -->                             <!-- ko if: columnType=='custome' -->                         <td class = 'ko-grid-center'><span class=btnsText><input type='button' class='btn-1' name='ko_grid_button' trans=edit data-bind='click:function(){$root.EditClickHandler($parent[rowText])},attr:{primaryValue:$parent[$root.primaryColumn],idValue:$parent[rowText]}'/><input type='button' class='btn-1' name='ko_grid_button' trans=delete data-bind='click:function(){$root.DeleteClickHandler($parent[rowText])},attr:{primaryValue:$parent[$root.primaryColumn],idValue:$parent[rowText]}'/></span></td> <!-- /ko -->                             <!-- ko if: columnType=='text' && !needTrans -->             <td class = 'ko-grid-center' data-bind=\"visible: display, css:{'cursor-pointer':$root.hasRowClickHandler },text: typeof rowText == 'function' ? rowText($parent) : $parent[rowText], click:function(){$root.rowClickHandler($parent[$root.idName])}\"></td> <!-- /ko -->                             <!-- ko if: columnType=='text' && needTrans -->              <td class = 'ko-grid-center' data-bind=\"visible: display, css:{'cursor-pointer':$root.hasRowClickHandler },click:function(){$root.rowClickHandler($parent[$root.idName])}\"> <span data-bind=\"attr: {trans: $parent[rowText]}\"></span>                            </td>                            <!-- /ko -->                           <!-- ko if: columnType=='images' --><td class = 'ko-grid-center' data-bind=\"visible: display, css:{'cursor-pointer':$root.hasRowClickHandler },click:function(){$root.rowClickHandler($parent[$root.idName])}\">                                <img data-bind=\"attr: {src: $parent[rowText]}\"/>                            </td>                            <!-- /ko -->                         </tr>                    </tbody>                </table>                </div>")}B.addTemplate("ko_simpleGrid_pageLinks","                    <div class=\"ko-grid-pageLinks\">                        <a class='ko-grid-pager' href='javascript:void(0)' data-bind=\"click:previousPage,enable:$root.fixCurrentPageIndex($root.currentPageIndex())>0,visible:$root.afterSearchData().length>0,css:{'ko-grid-pager-disabled': $root.fixCurrentPageIndex($root.currentPageIndex())==0}\">&lt;&lt;</a>                        <a href='javascript:void(0)' data-bind=\"visible:$root.afterSearchData().length>0,text: 1, click: function() { $root.changePage(0); }, css: {'ko-grid-pager-selected': 0 == $root.fixCurrentPageIndex($root.currentPageIndex()),'ko-grid-pager':0 != $root.fixCurrentPageIndex($root.currentPageIndex()) }\"></a>                        <span data-bind='visible:pagerStart()>2'>...</span>                        <!-- ko foreach: ko.utils.range(pagerStart,pagerEnd) -->                            <a href='javascript:void(0)' data-bind=\"text: $data + 1, click: function() { $root.changePage($data); }, disable:$data == $root.fixCurrentPageIndex($root.currentPageIndex()) ,css: {'ko-grid-pager-selected': $data == $root.fixCurrentPageIndex($root.currentPageIndex()),'ko-grid-pager':$data != $root.fixCurrentPageIndex($root.currentPageIndex()) }\"></a>                        <!-- /ko -->                        <span data-bind='visible:pagerEnd()<maxPageIndex()-2'>...</span>                        <a href='javascript:void(0)' data-bind=\"visible:maxPageIndex()>0,text: maxPageIndex()+1, click: function() { $root.changePage(maxPageIndex());}, css: {'ko-grid-pager-selected':  maxPageIndex() == $root.fixCurrentPageIndex($root.currentPageIndex()),'ko-grid-pager': maxPageIndex() != $root.fixCurrentPageIndex($root.currentPageIndex()) }\"></a>                        <a class='ko-grid-pager' href='javascript:void(0)' data-bind=\"click:nextPage,enable:$root.fixCurrentPageIndex($root.currentPageIndex())<maxPageIndex(),visible:$root.afterSearchData().length>0,css:{'ko-grid-pager-disabled': $root.fixCurrentPageIndex($root.currentPageIndex())==maxPageIndex()}\">&gt;&gt;</a>                        <span style='display:none;'><span>(</span><span id='ko_simpleGrid_recordCount' data-bind='text:$root.afterSearchData().length'></span><span>)</span></span>						<label class=\"marginleft10\" trans=\"page\"></label>						<input id=\"ko-grid-input-page\" type=\"text\" data-bind=\"value:pageToGo,valueUpdate: 'afterkeydown'\" />						<input type=\"button\" class=\"btn-1 btn-ex\" trans=\"go\" data-bind=\"click:function() { $root.changePage(parseInt(pageToGo())-1); pageToGo(''); },enable: /^[0-9]+$/.test(pageToGo()) && (parseInt(pageToGo())-1) <= maxPageIndex() && (parseInt(pageToGo())-1) >= 0\"/>                    </div>");return{controlsDescendantBindings:true}},update:function(H,K,G){var D=K(),J=G();while(H.firstChild){ko.removeNode(H.firstChild)}var F=J.simpleGridTemplate||"ko_simpleGrid_grid",C=J.simpleGridPagerTemplate||"ko_simpleGrid_pageLinks";var I=H.appendChild(document.createElement("DIV"));ko.renderTemplate(F,D,{templateEngine:B},I,"replaceNode");if(D.showPager){var E=H.appendChild(document.createElement("DIV"));ko.renderTemplate(C,D,{templateEngine:B},E,"replaceNode")}}}})();